import os
import subprocess
import numpy as np 
import multiprocessing
from math import gcd

used = set()

big_command_list = [['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=9.999999999999999e-06', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00000', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=2794979691', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=1.584893192461114e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00001', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=1298850854', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=2.5118864315095822e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00002', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=2324867908', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=3.9810717055349695e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00003', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=1221352795', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=6.309573444801929e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00004', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=2537739542', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=9.999999999999999e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00005', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=627250118', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.00015848931924611142', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00006', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=1868879351', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.0002511886431509582', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00007', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=2020356508', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.0003981071705534973', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00008', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=1050603933', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.000630957344480193', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00009', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=2536979734', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.001', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00010', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=2516872463', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.001584893192461114', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00011', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=3413598722', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.002511886431509582', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00012', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=685453632', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.003981071705534973', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00013', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=2017855025', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.006309573444801936', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00014', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=1244061156', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.01', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00015', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=512111155', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.01584893192461114', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00016', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=1161797296', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.025118864315095822', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00017', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=3118486039', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.039810717055349734', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00018', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=3183575997', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.06309573444801936', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00019', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=2592512736', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.09999999999999999', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00020', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=593765854', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=9.999999999999999e-06', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00021', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=2734450971', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=1.584893192461114e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00022', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=2130967407', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=2.5118864315095822e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00023', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=450094628', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=3.9810717055349695e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00024', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=402349885', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=6.309573444801929e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00025', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=3596685807', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=9.999999999999999e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00026', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=3601675602', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.00015848931924611142', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00027', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=1347439318', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.0002511886431509582', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00028', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=2809240500', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.0003981071705534973', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00029', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=3672942202', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.000630957344480193', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00030', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=2837779777', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.001', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00031', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=2438439592', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.001584893192461114', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00032', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=829347651', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.002511886431509582', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00033', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=1426547147', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.003981071705534973', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00034', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=194413818', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.006309573444801936', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00035', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=3253509635', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.01', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00036', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=4280932122', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.01584893192461114', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00037', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=3819711836', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.025118864315095822', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00038', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=1257784960', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.039810717055349734', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00039', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=4027727471', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.06309573444801936', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00040', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=1281964070', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.09999999999999999', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00041', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=1', '--seed=1819900400', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000']] + [['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=9.999999999999999e-06', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00000', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=2794979691', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=1.584893192461114e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00001', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=1298850854', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=2.5118864315095822e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00002', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=2324867908', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=3.9810717055349695e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00003', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=1221352795', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=6.309573444801929e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00004', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=2537739542', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=9.999999999999999e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00005', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=627250118', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.00015848931924611142', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00006', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=1868879351', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.0002511886431509582', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00007', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=2020356508', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.0003981071705534973', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00008', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=1050603933', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.000630957344480193', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00009', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=2536979734', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.001', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00010', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=2516872463', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.001584893192461114', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00011', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=3413598722', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.002511886431509582', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00012', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=685453632', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.003981071705534973', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00013', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=2017855025', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.006309573444801936', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00014', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=1244061156', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.01', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00015', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=512111155', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.01584893192461114', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00016', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=1161797296', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.025118864315095822', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00017', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=3118486039', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.039810717055349734', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00018', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=3183575997', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.06309573444801936', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00019', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=2592512736', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-reverse', '--threshold=0.09999999999999999', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00020', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=593765854', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=9.999999999999999e-06', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00021', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=2734450971', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=1.584893192461114e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00022', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=2130967407', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=2.5118864315095822e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00023', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=450094628', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=3.9810717055349695e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00024', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=402349885', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=6.309573444801929e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00025', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=3596685807', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=9.999999999999999e-05', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00026', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=3601675602', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.00015848931924611142', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00027', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=1347439318', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.0002511886431509582', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00028', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=2809240500', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.0003981071705534973', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00029', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=3672942202', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.000630957344480193', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00030', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=2837779777', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.001', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00031', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=2438439592', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.001584893192461114', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00032', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=829347651', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.002511886431509582', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00033', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=1426547147', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.003981071705534973', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00034', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=194413818', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.006309573444801936', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00035', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=3253509635', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.01', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00036', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=4280932122', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.01584893192461114', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00037', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=3819711836', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.025118864315095822', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00038', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=1257784960', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.039810717055349734', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00039', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=4027727471', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.06309573444801936', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00040', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=1281964070', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000'], ['python', 'acdc/main.py', '--task=tracr-proportion', '--threshold=0.09999999999999999', '--using-wandb', '--wandb-run-name=aconmy-tracr3-00041', '--wandb-group-name=reset-networks-neurips-6', '--wandb-project-name=acdc', '--device=cpu', '--reset-network=0', '--seed=1819900400', '--metric=l2', '--torch-num-threads=4', '--wandb-dir=/root/.cache/huggingface/tracr-training/acdc', '--wandb-mode=online', '--max-num-epochs=40000']]

def run_script(threshold, gpu_id):
    env = os.environ.copy()
    env["CUDA_VISIBLE_DEVICES"] = str(gpu_id)

    subprocess.run(["python", "main.py", "--task", "tracr-reverse", "--wandb-run-name", "tracr_new_" + str(threshold), "--metric", "l2", "--wandb-project-name", "acdc", "--wandb-group-name", "acdc-tracr-neurips-6", "--using-wandb", "--threshold", str(threshold), "--indices-mode", "reverse", "--first-cache-cpu", "False", "--second-cache-cpu", "False"], env=env)

# subprocess.run(["python", "main.py", "--task", "ioi", "--metric", "logit_diff", "--wandb-run-name", str(threshold), "--wandb-project-name", "arthur_ioi_abs", "--abs-value-threshold", "--using-wandb", "--threshold", str(threshold), "--indices-mode", "reverse", "--first-cache-cpu", "False", "--second-cache-cpu", "False"], env=env)
# subprocess.run(["python", "main.py", "--task", "induction", "--wandb-run-name", str(threshold), "--wandb-project-name", "arthur_ioi_abs", "--abs-value-threshold", "--using-wandb", "--threshold", str(threshold), "--indices-mode", "reverse", "--first-cache-cpu", "False", "--second-cache-cpu", "False"], env=env)
#     subprocess.run(["python", "subnetwork_probing/train.py", "--task", "docstring", "--lambda-reg", str(threshold)] + """--zero-ablation=0
# --wandb-name=my_edge_runs
# --wandb-project=edgesp
# --lr=0.001
# --wandb-entity=remix_school-of-rock
# --wandb-mode=online
# --loss-type=docstring_metric
# --sp=edge""".split('\n'), env=env)


if __name__ == '__main__':

    num_gpus = 1 # specify the number of GPUs available
    num_jobs_per_gpu = 8 # specify the number of jobs per GPU

    pool = multiprocessing.Pool(num_gpus * num_jobs_per_gpu)
    jobs = []

    for it in range(3, int(1e6)):
        curspace = np.linspace(0.02, 0.07, it) # for IOI
        curspace = [0.1,
            0.0631,
            0.02512,
            0.01585,
            0.01,
            0.00631,
            0.00398,
            0.00158,
            0.001,
            0.00025,
            0.00016,
            0.0001,
            6e-05,
            4e-05,
            3e-05,
            1e-05,
            6.309573444801943e-06,
            3.981071705534969e-06,
            1.584893192461114e-06,
            6.309573444801942e-07,
            3.981071705534969e-07,
            1.584893192461114e-07,
            1e-07,
            6.30957344480193e-08,
            3.9810717055349696e-08,
            2.511886431509582e-08,
            1e-08,
            6.309573444801943e-09,
            3.981071705534969e-09,
            2.511886431509582e-09,
            1.584893192461111e-09,
            1e-09,
        ]

        if not isinstance(curspace, list):
            curspace = curspace[1:-1]

        for threshold_idx, threshold in list(enumerate(curspace)):
            if threshold in used:
                continue
            used.add(threshold)

            gpu_id = (threshold_idx // num_jobs_per_gpu) % num_gpus
            jobs.append(pool.apply_async(run_script, (threshold, gpu_id)))

        if isinstance(curspace, list):
            break

    # wait for all jobs to finish
    for job in jobs:
        job.get()

    # clean up
    pool.close()
    pool.join()